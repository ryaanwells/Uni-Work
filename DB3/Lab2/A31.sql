CREATE INDEX syear ON MEMBEROF(STARTYEAR)
GO
CREATE INDEX bnames ON BAND(NAME)
go

SELECT DISTINCT MEMBER.NAME as Guitarist_Name, Band.Name as Band_Name, Mems.STARTYEAR as Start_Year, MEMS.ENDYEAR
FROM (
    SELECT BAND.BID,MEMBEROF.MID, MEMBEROF.STARTYEAR As STARTYEAR, MEMBEROF.ENDYEAR as ENDYEAR
    FROM MEMBEROF,BAND,RELEASE
    WHERE MEMBEROF.STARTYEAR IS NOT NULL AND MEMBEROF.INSTRUMENT='guitar'
    AND MEMBEROF.BID=BAND.BID AND BAND.BID=RELEASE.BID
    UNION ALL
    SELECT BAND.BID, MEMBEROF.MID, MIN(RELEASE.YEAR) AS year,MEMBEROF.ENDYEAR
    FROM BAND, RELEASE, MEMBEROF
    WHERE BAND.BID=RELEASE.BID AND MEMBEROF.INSTRUMENT='guitar' 
    AND MEMBEROF.BID = BAND.BID AND (MEMBEROF.STARTYEAR IS NULL)
    GROUP BY MEMBEROF.MID, BAND.BID,MEMBEROF.ENDYEAR) MEMS, MEMBER, BAND
WHERE MEMS.MID=MEMBER.MID AND BAND.BID=MEMS.BID
ORDER BY MEMBER.NAME, MEMS.STARTYEAR
go